<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>WebView Bridge SDK Demo</title>
    <style>
        :root {
            --primary-color: #007AFF;
            --success-color: #34C759;
            --warning-color: #FF9500;
            --danger-color: #FF3B30;
            --bg-color: #F2F2F7;
            --card-bg: #FFFFFF;
            --text-color: #000000;
            --text-secondary: #8E8E93;
            --border-color: #C6C6C8;
            --safe-area-top: env(safe-area-inset-top, 0px);
            --safe-area-bottom: env(safe-area-inset-bottom, 0px);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #000000;
                --card-bg: #1C1C1E;
                --text-color: #FFFFFF;
                --text-secondary: #8E8E93;
                --border-color: #38383A;
            }
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            padding-top: var(--safe-area-top);
            padding-bottom: var(--safe-area-bottom);
            min-height: 100vh;
        }

        .header {
            background-color: var(--card-bg);
            padding: 16px 20px;
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 700;
        }

        .header p {
            color: var(--text-secondary);
            font-size: 14px;
            margin-top: 4px;
        }

        .container {
            padding: 16px;
            max-width: 600px;
            margin: 0 auto;
        }

        .section {
            background-color: var(--card-bg);
            border-radius: 12px;
            margin-bottom: 16px;
            overflow: hidden;
        }

        .section-header {
            padding: 12px 16px;
            background-color: rgba(0, 0, 0, 0.03);
            border-bottom: 1px solid var(--border-color);
        }

        @media (prefers-color-scheme: dark) {
            .section-header {
                background-color: rgba(255, 255, 255, 0.05);
            }
        }

        .section-header h2 {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        .section-content {
            padding: 0;
        }

        .btn-row {
            display: flex;
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
            align-items: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .btn-row:last-child {
            border-bottom: none;
        }

        .btn-row:active {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .btn-row .btn-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            margin-right: 12px;
        }

        .btn-row .btn-content {
            flex: 1;
        }

        .btn-row .btn-title {
            font-size: 16px;
            font-weight: 500;
        }

        .btn-row .btn-desc {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        .btn-row .btn-arrow {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .icon-app { background-color: #007AFF; color: white; }
        .icon-device { background-color: #5856D6; color: white; }
        .icon-permission { background-color: #FF9500; color: white; }
        .icon-clipboard { background-color: #34C759; color: white; }
        .icon-haptics { background-color: #FF2D55; color: white; }
        .icon-statusbar { background-color: #00C7BE; color: white; }
        .icon-system { background-color: #AF52DE; color: white; }
        .icon-storage { background-color: #FF3B30; color: white; }

        .result-panel {
            background-color: var(--card-bg);
            border-radius: 12px;
            margin-bottom: 16px;
            overflow: hidden;
        }

        .result-header {
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
        }

        .result-header h3 {
            font-size: 14px;
            font-weight: 600;
        }

        .result-header button {
            background: none;
            border: none;
            color: var(--primary-color);
            font-size: 14px;
            cursor: pointer;
        }

        .result-content {
            padding: 12px 16px;
            max-height: 300px;
            overflow-y: auto;
        }

        .result-content pre {
            font-family: 'SF Mono', Monaco, Consolas, monospace;
            font-size: 12px;
            white-space: pre-wrap;
            word-break: break-all;
            color: var(--text-color);
        }

        .result-content .success {
            color: var(--success-color);
        }

        .result-content .error {
            color: var(--danger-color);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: var(--card-bg);
            border-radius: 16px;
            width: 90%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            font-size: 18px;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-secondary);
            cursor: pointer;
        }

        .modal-body {
            padding: 16px;
        }

        .input-group {
            margin-bottom: 16px;
        }

        .input-group label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 8px;
        }

        .input-group input,
        .input-group select,
        .input-group textarea {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        .modal-footer {
            padding: 16px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 12px;
        }

        .modal-footer button {
            flex: 1;
            padding: 12px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            border: none;
        }

        .modal-footer .btn-cancel {
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        .modal-footer .btn-confirm {
            background-color: var(--primary-color);
            color: white;
        }

        .toast {
            position: fixed;
            bottom: calc(100px + var(--safe-area-bottom));
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .toast.show {
            opacity: 1;
        }

        .event-log {
            background-color: var(--card-bg);
            border-radius: 12px;
            margin-bottom: 16px;
            overflow: hidden;
        }

        .event-log-header {
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
        }

        .event-log-content {
            padding: 0;
            max-height: 200px;
            overflow-y: auto;
        }

        .event-item {
            padding: 8px 16px;
            border-bottom: 1px solid var(--border-color);
            font-size: 12px;
        }

        .event-item:last-child {
            border-bottom: none;
        }

        .event-item .event-name {
            color: var(--primary-color);
            font-weight: 600;
        }

        .event-item .event-time {
            color: var(--text-secondary);
            font-size: 10px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸŒ‰ Bridge Demo</h1>
        <p>WebView Bridge SDK åŠŸèƒ½æ¼”ç¤º</p>
    </div>

    <div class="container">
        <!-- ç»“æœé¢æ¿ -->
        <div class="result-panel">
            <div class="result-header">
                <h3>ğŸ“‹ æ‰§è¡Œç»“æœ</h3>
                <button onclick="clearResult()">æ¸…ç©º</button>
            </div>
            <div class="result-content">
                <pre id="resultContent">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æµ‹è¯• SDK åŠŸèƒ½</pre>
            </div>
        </div>

        <!-- äº‹ä»¶æ—¥å¿— -->
        <div class="event-log">
            <div class="event-log-header">
                <h3>ğŸ“¡ äº‹ä»¶æ—¥å¿—</h3>
                <button onclick="clearEvents()" style="background:none;border:none;color:var(--primary-color);cursor:pointer;">æ¸…ç©º</button>
            </div>
            <div class="event-log-content" id="eventLog">
                <div class="event-item" style="color: var(--text-secondary);">æš‚æ— äº‹ä»¶</div>
            </div>
        </div>

        <!-- App æ¨¡å— -->
        <div class="section">
            <div class="section-header">
                <h2>App æ¨¡å—</h2>
            </div>
            <div class="section-content">
                <div class="btn-row" onclick="callApi('app.getAppInfo')">
                    <div class="btn-icon icon-app">ğŸ“±</div>
                    <div class="btn-content">
                        <div class="btn-title">è·å–åº”ç”¨ä¿¡æ¯</div>
                        <div class="btn-desc">App.GetAppInfo</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('app.getLaunchParams')">
                    <div class="btn-icon icon-app">ğŸš€</div>
                    <div class="btn-content">
                        <div class="btn-title">è·å–å¯åŠ¨å‚æ•°</div>
                        <div class="btn-desc">App.GetLaunchParams</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('app.getLifecycleState')">
                    <div class="btn-icon icon-app">â™»ï¸</div>
                    <div class="btn-content">
                        <div class="btn-title">è·å–ç”Ÿå‘½å‘¨æœŸçŠ¶æ€</div>
                        <div class="btn-desc">App.GetLifecycleState</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
            </div>
        </div>

        <!-- Device æ¨¡å— -->
        <div class="section">
            <div class="section-header">
                <h2>Device æ¨¡å—</h2>
            </div>
            <div class="section-content">
                <div class="btn-row" onclick="callApi('device.getInfo')">
                    <div class="btn-icon icon-device">ğŸ“Ÿ</div>
                    <div class="btn-content">
                        <div class="btn-title">è·å–è®¾å¤‡ä¿¡æ¯</div>
                        <div class="btn-desc">Device.GetInfo</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('device.getBatteryInfo')">
                    <div class="btn-icon icon-device">ğŸ”‹</div>
                    <div class="btn-content">
                        <div class="btn-title">è·å–ç”µæ± ä¿¡æ¯</div>
                        <div class="btn-desc">Device.GetBatteryInfo</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('device.getNetworkInfo')">
                    <div class="btn-icon icon-device">ğŸ“¶</div>
                    <div class="btn-content">
                        <div class="btn-title">è·å–ç½‘ç»œä¿¡æ¯</div>
                        <div class="btn-desc">Device.GetNetworkInfo</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('device.getCapabilities')">
                    <div class="btn-icon icon-device">âš™ï¸</div>
                    <div class="btn-content">
                        <div class="btn-title">è·å–è®¾å¤‡èƒ½åŠ›</div>
                        <div class="btn-desc">Device.GetCapabilities</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
            </div>
        </div>

        <!-- Permission æ¨¡å— -->
        <div class="section">
            <div class="section-header">
                <h2>Permission æ¨¡å—</h2>
            </div>
            <div class="section-content">
                <div class="btn-row" onclick="showPermissionModal('getStatus')">
                    <div class="btn-icon icon-permission">ğŸ”</div>
                    <div class="btn-content">
                        <div class="btn-title">æŸ¥è¯¢æƒé™çŠ¶æ€</div>
                        <div class="btn-desc">Permission.GetStatus</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="showPermissionModal('request')">
                    <div class="btn-icon icon-permission">âœ‹</div>
                    <div class="btn-content">
                        <div class="btn-title">è¯·æ±‚æƒé™</div>
                        <div class="btn-desc">Permission.Request</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('permission.openSettings')">
                    <div class="btn-icon icon-permission">âš™ï¸</div>
                    <div class="btn-content">
                        <div class="btn-title">æ‰“å¼€ç³»ç»Ÿè®¾ç½®</div>
                        <div class="btn-desc">Permission.OpenSettings</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
            </div>
        </div>

        <!-- Clipboard æ¨¡å— -->
        <div class="section">
            <div class="section-header">
                <h2>Clipboard æ¨¡å—</h2>
            </div>
            <div class="section-content">
                <div class="btn-row" onclick="callApi('clipboard.read')">
                    <div class="btn-icon icon-clipboard">ğŸ“‹</div>
                    <div class="btn-content">
                        <div class="btn-title">è¯»å–å‰ªè´´æ¿</div>
                        <div class="btn-desc">Clipboard.Read</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="showClipboardModal()">
                    <div class="btn-icon icon-clipboard">âœï¸</div>
                    <div class="btn-content">
                        <div class="btn-title">å†™å…¥å‰ªè´´æ¿</div>
                        <div class="btn-desc">Clipboard.Write</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('clipboard.getAvailableTypes')">
                    <div class="btn-icon icon-clipboard">ğŸ“‘</div>
                    <div class="btn-content">
                        <div class="btn-title">è·å–å¯ç”¨ç±»å‹</div>
                        <div class="btn-desc">Clipboard.GetAvailableTypes</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
            </div>
        </div>

        <!-- Haptics æ¨¡å— -->
        <div class="section">
            <div class="section-header">
                <h2>Haptics æ¨¡å—</h2>
            </div>
            <div class="section-content">
                <div class="btn-row" onclick="callApi('haptics.impact', { style: 'light' })">
                    <div class="btn-icon icon-haptics">ğŸ’«</div>
                    <div class="btn-content">
                        <div class="btn-title">è½»è§¦åé¦ˆ</div>
                        <div class="btn-desc">Haptics.Impact (light)</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('haptics.impact', { style: 'medium' })">
                    <div class="btn-icon icon-haptics">âš¡</div>
                    <div class="btn-content">
                        <div class="btn-title">ä¸­ç­‰åé¦ˆ</div>
                        <div class="btn-desc">Haptics.Impact (medium)</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('haptics.impact', { style: 'heavy' })">
                    <div class="btn-icon icon-haptics">ğŸ’¥</div>
                    <div class="btn-content">
                        <div class="btn-title">é‡è§¦åé¦ˆ</div>
                        <div class="btn-desc">Haptics.Impact (heavy)</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('haptics.notification', { type: 'success' })">
                    <div class="btn-icon icon-haptics">âœ…</div>
                    <div class="btn-content">
                        <div class="btn-title">æˆåŠŸé€šçŸ¥</div>
                        <div class="btn-desc">Haptics.Notification (success)</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('haptics.selection')">
                    <div class="btn-icon icon-haptics">ğŸ‘†</div>
                    <div class="btn-content">
                        <div class="btn-title">é€‰æ‹©åé¦ˆ</div>
                        <div class="btn-desc">Haptics.Selection</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
            </div>
        </div>

        <!-- StatusBar æ¨¡å— -->
        <div class="section">
            <div class="section-header">
                <h2>StatusBar æ¨¡å—</h2>
            </div>
            <div class="section-content">
                <div class="btn-row" onclick="callApi('statusbar.getInfo')">
                    <div class="btn-icon icon-statusbar">ğŸ“Š</div>
                    <div class="btn-content">
                        <div class="btn-title">è·å–çŠ¶æ€æ ä¿¡æ¯</div>
                        <div class="btn-desc">StatusBar.GetInfo</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('statusbar.setStyle', { style: 'light' })">
                    <div class="btn-icon icon-statusbar">â˜€ï¸</div>
                    <div class="btn-content">
                        <div class="btn-title">è®¾ç½®æµ…è‰²æ ·å¼</div>
                        <div class="btn-desc">StatusBar.SetStyle (light)</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('statusbar.setStyle', { style: 'dark' })">
                    <div class="btn-icon icon-statusbar">ğŸŒ™</div>
                    <div class="btn-content">
                        <div class="btn-title">è®¾ç½®æ·±è‰²æ ·å¼</div>
                        <div class="btn-desc">StatusBar.SetStyle (dark)</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
            </div>
        </div>

        <!-- System æ¨¡å— -->
        <div class="section">
            <div class="section-header">
                <h2>System æ¨¡å—</h2>
            </div>
            <div class="section-content">
                <div class="btn-row" onclick="callApi('system.getInfo')">
                    <div class="btn-icon icon-system">â„¹ï¸</div>
                    <div class="btn-content">
                        <div class="btn-title">è·å–ç³»ç»Ÿä¿¡æ¯</div>
                        <div class="btn-desc">System.GetInfo</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('system.getSafeArea')">
                    <div class="btn-icon icon-system">ğŸ“</div>
                    <div class="btn-content">
                        <div class="btn-title">è·å–å®‰å…¨åŒºåŸŸ</div>
                        <div class="btn-desc">System.GetSafeArea</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('system.getColorScheme')">
                    <div class="btn-icon icon-system">ğŸ¨</div>
                    <div class="btn-content">
                        <div class="btn-title">è·å–é¢œè‰²æ¨¡å¼</div>
                        <div class="btn-desc">System.GetColorScheme</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="showShareModal()">
                    <div class="btn-icon icon-system">ğŸ“¤</div>
                    <div class="btn-content">
                        <div class="btn-title">åˆ†äº«</div>
                        <div class="btn-desc">System.Share</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="showOpenURLModal()">
                    <div class="btn-icon icon-system">ğŸ”—</div>
                    <div class="btn-content">
                        <div class="btn-title">æ‰“å¼€ URL</div>
                        <div class="btn-desc">System.OpenURL</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
            </div>
        </div>

        <!-- Storage æ¨¡å— -->
        <div class="section">
            <div class="section-header">
                <h2>Storage æ¨¡å—</h2>
            </div>
            <div class="section-content">
                <div class="btn-row" onclick="showStorageModal('set')">
                    <div class="btn-icon icon-storage">ğŸ’¾</div>
                    <div class="btn-content">
                        <div class="btn-title">å­˜å‚¨æ•°æ®</div>
                        <div class="btn-desc">Storage.Set</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="showStorageModal('get')">
                    <div class="btn-icon icon-storage">ğŸ“–</div>
                    <div class="btn-content">
                        <div class="btn-title">è¯»å–æ•°æ®</div>
                        <div class="btn-desc">Storage.Get</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('storage.getKeys')">
                    <div class="btn-icon icon-storage">ğŸ”‘</div>
                    <div class="btn-content">
                        <div class="btn-title">è·å–æ‰€æœ‰é”®</div>
                        <div class="btn-desc">Storage.GetKeys</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
                <div class="btn-row" onclick="callApi('storage.getSize')">
                    <div class="btn-icon icon-storage">ğŸ“Š</div>
                    <div class="btn-content">
                        <div class="btn-title">è·å–å­˜å‚¨å¤§å°</div>
                        <div class="btn-desc">Storage.GetSize</div>
                    </div>
                    <div class="btn-arrow">â€º</div>
                </div>
            </div>
        </div>
    </div>

    <!-- æƒé™é€‰æ‹©å¼¹çª— -->
    <div class="modal" id="permissionModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>é€‰æ‹©æƒé™</h3>
                <button class="modal-close" onclick="closeModal('permissionModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label>æƒé™ç±»å‹</label>
                    <select id="permissionType">
                        <option value="camera">ç›¸æœº (camera)</option>
                        <option value="microphone">éº¦å…‹é£ (microphone)</option>
                        <option value="photos">ç›¸å†Œ (photos)</option>
                        <option value="locationWhenInUse">ä½ç½® (locationWhenInUse)</option>
                        <option value="contacts">é€šè®¯å½• (contacts)</option>
                        <option value="calendar">æ—¥å† (calendar)</option>
                        <option value="notifications">é€šçŸ¥ (notifications)</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" onclick="closeModal('permissionModal')">å–æ¶ˆ</button>
                <button class="btn-confirm" id="permissionConfirmBtn">ç¡®å®š</button>
            </div>
        </div>
    </div>

    <!-- å‰ªè´´æ¿å¼¹çª— -->
    <div class="modal" id="clipboardModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>å†™å…¥å‰ªè´´æ¿</h3>
                <button class="modal-close" onclick="closeModal('clipboardModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label>å†…å®¹</label>
                    <textarea id="clipboardContent" rows="3" placeholder="è¾“å…¥è¦å¤åˆ¶çš„å†…å®¹">Hello from WebView Bridge!</textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" onclick="closeModal('clipboardModal')">å–æ¶ˆ</button>
                <button class="btn-confirm" onclick="writeClipboard()">å¤åˆ¶</button>
            </div>
        </div>
    </div>

    <!-- åˆ†äº«å¼¹çª— -->
    <div class="modal" id="shareModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>åˆ†äº«å†…å®¹</h3>
                <button class="modal-close" onclick="closeModal('shareModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label>æ–‡æœ¬</label>
                    <textarea id="shareText" rows="2" placeholder="åˆ†äº«çš„æ–‡æœ¬å†…å®¹">æ¥è‡ª WebView Bridge SDK çš„åˆ†äº«</textarea>
                </div>
                <div class="input-group">
                    <label>URL</label>
                    <input type="url" id="shareUrl" placeholder="https://example.com" value="https://github.com">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" onclick="closeModal('shareModal')">å–æ¶ˆ</button>
                <button class="btn-confirm" onclick="doShare()">åˆ†äº«</button>
            </div>
        </div>
    </div>

    <!-- æ‰“å¼€ URL å¼¹çª— -->
    <div class="modal" id="openURLModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>æ‰“å¼€ URL</h3>
                <button class="modal-close" onclick="closeModal('openURLModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label>URL</label>
                    <input type="url" id="openURLInput" placeholder="https://example.com" value="https://www.apple.com">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" onclick="closeModal('openURLModal')">å–æ¶ˆ</button>
                <button class="btn-confirm" onclick="doOpenURL()">æ‰“å¼€</button>
            </div>
        </div>
    </div>

    <!-- å­˜å‚¨å¼¹çª— -->
    <div class="modal" id="storageModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="storageModalTitle">å­˜å‚¨æ“ä½œ</h3>
                <button class="modal-close" onclick="closeModal('storageModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label>é”®å</label>
                    <input type="text" id="storageKey" placeholder="key" value="testKey">
                </div>
                <div class="input-group" id="storageValueGroup">
                    <label>å€¼</label>
                    <textarea id="storageValue" rows="2" placeholder="value">Hello World</textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" onclick="closeModal('storageModal')">å–æ¶ˆ</button>
                <button class="btn-confirm" id="storageConfirmBtn">ç¡®å®š</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <script>
        // æ¨¡æ‹Ÿ Bridge å¯¹è±¡ï¼ˆå®é™…ç”± Native æ³¨å…¥ï¼‰
        let bridge = null;
        let events = [];

        // æ£€æµ‹è¿è¡Œç¯å¢ƒ
        function initBridge() {
            // iOS WKWebView
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.NativeBridge) {
                bridge = {
                    postMessage: (msg) => window.webkit.messageHandlers.NativeBridge.postMessage(msg)
                };
            }
            // Android WebView
            else if (window.NativeBridge) {
                bridge = {
                    postMessage: (msg) => window.NativeBridge.postMessage(msg)
                };
            }
            // æµè§ˆå™¨æ¨¡æ‹Ÿ
            else {
                bridge = {
                    postMessage: (msg) => {
                        console.log('Bridge Message:', msg);
                        // æ¨¡æ‹Ÿå“åº”
                        setTimeout(() => {
                            const request = JSON.parse(msg);
                            mockResponse(request);
                        }, 100);
                    }
                };
                showToast('åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ¨¡å¼');
            }
        }

        // å›è°ƒå­˜å‚¨
        const callbacks = {};
        let callbackId = 0;

        // å‘é€è¯·æ±‚
        function sendRequest(type, params = {}) {
            return new Promise((resolve, reject) => {
                const id = `cb_${++callbackId}`;
                callbacks[id] = { resolve, reject };

                const request = {
                    version: '1.0',
                    type: type,
                    params: params,
                    callbackId: id
                };

                bridge.postMessage(JSON.stringify(request));

                // è¶…æ—¶å¤„ç†
                setTimeout(() => {
                    if (callbacks[id]) {
                        delete callbacks[id];
                        reject(new Error('è¯·æ±‚è¶…æ—¶'));
                    }
                }, 10000);
            });
        }

        // æ¥æ”¶å“åº”
        window.__bridgeCallback = function(responseJson) {
            try {
                const response = JSON.parse(responseJson);
                const callback = callbacks[response.callbackId];
                
                if (callback) {
                    delete callbacks[response.callbackId];
                    
                    if (response.code === 0) {
                        callback.resolve(response.data);
                    } else {
                        callback.reject(new Error(response.msg));
                    }
                }
            } catch (e) {
                console.error('è§£æå“åº”å¤±è´¥:', e);
            }
        };

        // æ¥æ”¶äº‹ä»¶
        window.__bridgeEvent = function(eventJson) {
            try {
                const event = JSON.parse(eventJson);
                addEventLog(event.eventName, event.data);
            } catch (e) {
                console.error('è§£æäº‹ä»¶å¤±è´¥:', e);
            }
        };

        // æ¨¡æ‹Ÿå“åº”ï¼ˆæµè§ˆå™¨æ¨¡å¼ï¼‰
        function mockResponse(request) {
            const mockData = {
                'App.GetAppInfo': {
                    name: 'Demo App',
                    version: '1.0.0',
                    packageName: 'com.example.demo'
                },
                'App.GetLaunchParams': {
                    params: { source: 'browser' }
                },
                'App.GetLifecycleState': {
                    state: 'active'
                },
                'Device.GetInfo': {
                    platform: 'web',
                    osVersion: navigator.userAgent,
                    model: 'Browser'
                },
                'Device.GetBatteryInfo': {
                    level: 0.75,
                    isCharging: true
                },
                'Device.GetNetworkInfo': {
                    isConnected: navigator.onLine,
                    type: 'wifi'
                },
                'Device.GetCapabilities': {
                    hasCamera: true,
                    hasMicrophone: true,
                    hasGps: true
                },
                'Clipboard.Read': {
                    type: 'text',
                    content: 'æ¨¡æ‹Ÿå‰ªè´´æ¿å†…å®¹'
                },
                'Clipboard.GetAvailableTypes': {
                    types: ['text'],
                    isEmpty: false
                },
                'Haptics.IsSupported': {
                    supported: false
                },
                'StatusBar.GetInfo': {
                    style: 'default',
                    visible: true,
                    height: 44
                },
                'System.GetInfo': {
                    platform: 'web',
                    osVersion: navigator.platform,
                    language: navigator.language
                },
                'System.GetSafeArea': {
                    top: 0,
                    bottom: 0,
                    left: 0,
                    right: 0
                },
                'System.GetColorScheme': {
                    colorScheme: window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
                },
                'Storage.GetKeys': {
                    keys: ['testKey']
                },
                'Storage.GetSize': {
                    bytes: 1024,
                    formatted: '1 KB'
                }
            };

            const response = {
                callbackId: request.callbackId,
                code: 0,
                msg: 'success',
                data: mockData[request.type] || {}
            };

            window.__bridgeCallback(JSON.stringify(response));
        }

        // API è°ƒç”¨å°è£…
        async function callApi(apiName, params = {}) {
            const [module, method] = apiName.split('.');
            const type = `${capitalize(module)}.${capitalize(method)}`;

            showResult(`è°ƒç”¨: ${type}\nå‚æ•°: ${JSON.stringify(params, null, 2)}\n\nè¯·æ±‚ä¸­...`, '');

            try {
                const result = await sendRequest(type, params);
                showResult(`è°ƒç”¨: ${type}\nå‚æ•°: ${JSON.stringify(params, null, 2)}\n\nç»“æœ:`, JSON.stringify(result, null, 2), 'success');
            } catch (error) {
                showResult(`è°ƒç”¨: ${type}\nå‚æ•°: ${JSON.stringify(params, null, 2)}\n\né”™è¯¯:`, error.message, 'error');
            }
        }

        function capitalize(str) {
            return str.charAt(0).toUpperCase() + str.slice(1);
        }

        // UI å‡½æ•°
        function showResult(title, content, type = '') {
            const el = document.getElementById('resultContent');
            el.innerHTML = `${title}\n<span class="${type}">${content}</span>`;
        }

        function clearResult() {
            document.getElementById('resultContent').textContent = 'ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æµ‹è¯• SDK åŠŸèƒ½';
        }

        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }

        function showModal(id) {
            document.getElementById(id).classList.add('active');
        }

        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
        }

        // äº‹ä»¶æ—¥å¿—
        function addEventLog(eventName, data) {
            const container = document.getElementById('eventLog');
            const time = new Date().toLocaleTimeString();
            
            const item = document.createElement('div');
            item.className = 'event-item';
            item.innerHTML = `
                <span class="event-name">${eventName}</span>
                <span class="event-time"> - ${time}</span>
                <div style="color: var(--text-secondary); margin-top: 4px;">${JSON.stringify(data)}</div>
            `;
            
            // ç§»é™¤"æš‚æ— äº‹ä»¶"æç¤º
            if (events.length === 0) {
                container.innerHTML = '';
            }
            
            container.insertBefore(item, container.firstChild);
            events.push({ eventName, data, time });
            
            // é™åˆ¶æ—¥å¿—æ•°é‡
            if (events.length > 50) {
                events.shift();
                container.removeChild(container.lastChild);
            }
        }

        function clearEvents() {
            events = [];
            document.getElementById('eventLog').innerHTML = '<div class="event-item" style="color: var(--text-secondary);">æš‚æ— äº‹ä»¶</div>';
        }

        // æƒé™ç›¸å…³
        let permissionAction = 'getStatus';

        function showPermissionModal(action) {
            permissionAction = action;
            document.getElementById('permissionConfirmBtn').onclick = doPermissionAction;
            showModal('permissionModal');
        }

        async function doPermissionAction() {
            closeModal('permissionModal');
            const permission = document.getElementById('permissionType').value;
            
            if (permissionAction === 'getStatus') {
                await callApi('permission.getStatus', { permission });
            } else {
                await callApi('permission.request', { permission });
            }
        }

        // å‰ªè´´æ¿ç›¸å…³
        function showClipboardModal() {
            showModal('clipboardModal');
        }

        async function writeClipboard() {
            closeModal('clipboardModal');
            const content = document.getElementById('clipboardContent').value;
            await callApi('clipboard.write', { type: 'text', content });
        }

        // åˆ†äº«ç›¸å…³
        function showShareModal() {
            showModal('shareModal');
        }

        async function doShare() {
            closeModal('shareModal');
            const text = document.getElementById('shareText').value;
            const url = document.getElementById('shareUrl').value;
            await callApi('system.share', { text, url });
        }

        // æ‰“å¼€ URL ç›¸å…³
        function showOpenURLModal() {
            showModal('openURLModal');
        }

        async function doOpenURL() {
            closeModal('openURLModal');
            const url = document.getElementById('openURLInput').value;
            await callApi('system.openURL', { url });
        }

        // å­˜å‚¨ç›¸å…³
        let storageAction = 'set';

        function showStorageModal(action) {
            storageAction = action;
            const valueGroup = document.getElementById('storageValueGroup');
            const title = document.getElementById('storageModalTitle');
            const btn = document.getElementById('storageConfirmBtn');
            
            if (action === 'set') {
                title.textContent = 'å­˜å‚¨æ•°æ®';
                valueGroup.style.display = 'block';
                btn.textContent = 'ä¿å­˜';
            } else {
                title.textContent = 'è¯»å–æ•°æ®';
                valueGroup.style.display = 'none';
                btn.textContent = 'è¯»å–';
            }
            
            btn.onclick = doStorageAction;
            showModal('storageModal');
        }

        async function doStorageAction() {
            closeModal('storageModal');
            const key = document.getElementById('storageKey').value;
            
            if (storageAction === 'set') {
                const value = document.getElementById('storageValue').value;
                await callApi('storage.set', { key, value });
            } else {
                await callApi('storage.get', { key });
            }
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            initBridge();
            
            // ç›‘å¬é¢œè‰²æ¨¡å¼å˜åŒ–
            if (window.matchMedia) {
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                    addEventLog('appearanceChanged', { colorScheme: e.matches ? 'dark' : 'light' });
                });
            }

            // ç›‘å¬ç½‘ç»œçŠ¶æ€å˜åŒ–
            window.addEventListener('online', () => {
                addEventLog('networkChanged', { isConnected: true });
            });
            window.addEventListener('offline', () => {
                addEventLog('networkChanged', { isConnected: false });
            });

            // ç›‘å¬åº”ç”¨å¯è§æ€§å˜åŒ–
            document.addEventListener('visibilitychange', () => {
                if (document.hidden) {
                    addEventLog('background', {});
                } else {
                    addEventLog('foreground', {});
                }
            });
        });
    </script>
</body>
</html>
